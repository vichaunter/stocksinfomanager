const CSV = require('csv-string');
const { writeFile } = require("fs");

const history = `
Date(UTC),Pair,Side,Price,Executed,Amount,Fee
2023-05-10 18:02:06,ETHBTC,BUY,0.0664970000,0.8960000000ETH,0.05958131BTC,0.0008960000ETH
2023-05-10 18:02:06,ETHBTC,BUY,0.0664970000,0.6657000000ETH,0.04426705BTC,0.0006657000ETH
2023-05-10 18:02:06,ETHBTC,BUY,0.0664970000,1.0000000000ETH,0.06649700BTC,0.0010000000ETH
2023-05-10 18:00:11,ETHUSDT,BUY,"1,831.0100000000",2.8587000000ETH,"5,234.30828700USDT",0.0028587000ETH
2023-05-10 17:59:49,ARBUSDT,SELL,1.1522000000,"1,271.5000000000ARB","1,465.02230000USDT",1.4650223000USDT
2023-05-10 17:59:49,ARBUSDT,SELL,1.1521000000,265.4000000000ARB,305.76734000USDT,0.3057673400USDT
2023-05-10 17:59:49,ARBUSDT,SELL,1.1523000000,500.1000000000ARB,576.26523000USDT,0.5762652300USDT
2023-05-10 17:59:49,ARBUSDT,SELL,1.1522000000,395.9000000000ARB,456.15598000USDT,0.4561559800USDT
2023-05-10 17:59:49,ARBUSDT,SELL,1.1524000000,"2,114.0000000000ARB","2,436.17360000USDT",2.4361736000USDT
2023-05-10 17:56:07,ETHUSDT,BUY,"1,823.8600000000",0.0057000000ETH,10.39600200USDT,0.0000057000ETH
2023-05-10 17:56:07,ETHUSDT,BUY,"1,823.8600000000",0.6260000000ETH,"1,141.73636000USDT",0.0006260000ETH
2023-05-05 15:03:54,ETHUSDT,BUY,"1,952.6000000000",0.0833000000ETH,162.65158000USDT,0.0000833000ETH
2023-05-05 15:03:54,ETHUSDT,BUY,"1,952.6000000000",0.1727000000ETH,337.21402000USDT,0.0001727000ETH
2023-05-01 19:12:14,ARBUSDT,BUY,1.3000000000,553.8000000000ARB,719.94000000USDT,0.5538000000ARB
2023-05-01 19:12:14,ARBUSDT,BUY,1.3000000000,40.1000000000ARB,52.13000000USDT,0.0401000000ARB
2023-05-01 19:12:14,ARBUSDT,BUY,1.3000000000,107.2000000000ARB,139.36000000USDT,0.1072000000ARB
2023-05-01 19:12:14,ARBUSDT,BUY,1.3000000000,"2,310.0000000000ARB","3,003.00000000USDT",2.3100000000ARB
2023-05-01 19:12:14,ARBUSDT,BUY,1.3000000000,221.3000000000ARB,287.69000000USDT,0.2213000000ARB
2023-05-01 19:12:13,ARBUSDT,BUY,1.3000000000,20.9000000000ARB,27.17000000USDT,0.0209000000ARB
2023-05-01 19:12:13,ARBUSDT,BUY,1.3000000000,330.9000000000ARB,430.17000000USDT,0.3309000000ARB
2023-05-01 19:12:13,ARBUSDT,BUY,1.3000000000,261.9000000000ARB,340.47000000USDT,0.2619000000ARB
2023-04-19 08:43:52,BTCUSDT,BUY,"29,320.4300000000",0.1705200000BTC,"4,999.71972360USDT",0.0001705200BTC
2023-04-14 08:06:10,ARBUSDT,SELL,1.5320000000,"3,270.2000000000ARB","5,009.94640000USDT",5.0099464000USDT
2023-04-10 22:02:32,BTCUSDT,SELL,"29,490.0000000000",0.1779800000BTC,"5,248.63020000USDT",5.2486302000USDT
2023-04-09 19:16:16,BTCUSDT,SELL,"28,120.0000000000",0.0358500000BTC,"1,008.10200000USDT",1.0081020000USDT
2023-04-09 14:35:25,BTCUSDT,BUY,"27,857.8200000000",0.0358900000BTC,999.81715980USDT,0.0000358900BTC
2023-04-08 11:20:57,ETHUSDT,BUY,"1,868.0600000000",0.5700000000ETH,"1,064.79420000USDT",0.0005700000ETH
2023-04-08 11:20:57,ETHUSDT,BUY,"1,868.0600000000",0.9592000000ETH,"1,791.84315200USDT",0.0009592000ETH
2023-04-08 11:20:57,ETHUSDT,BUY,"1,868.0600000000",0.1565000000ETH,292.35139000USDT,0.0001565000ETH
2023-04-08 11:20:57,ETHUSDT,BUY,"1,868.0600000000",1.0621000000ETH,"1,984.06652600USDT",0.0010621000ETH
2023-04-08 11:20:57,ETHUSDT,BUY,"1,868.0600000000",2.5658000000ETH,"4,793.06834800USDT",0.0025658000ETH
2023-04-08 11:20:57,ETHUSDT,BUY,"1,868.0600000000",0.0395000000ETH,73.78837000USDT,0.0000395000ETH
2023-04-05 15:37:53,BTCUSDT,BUY,"28,065.8900000000",0.1781500000BTC,"4,999.93830350USDT",0.0001781500BTC
2023-04-05 00:33:37,BTCUSDT,SELL,"28,394.0000000000",0.0711000000BTC,"2,018.81340000USDT",2.0188134000USDT
2023-04-04 15:08:29,BTCUSDT,BUY,"28,101.1900000000",0.0711700000BTC,"1,999.96169230USDT",0.0000711700BTC
2023-04-04 11:08:30,BTCUSDT,SELL,"28,441.0000000000",0.0070000000BTC,199.08700000USDT,0.1990870000USDT
2023-04-04 11:08:30,BTCUSDT,SELL,"28,441.0000000000",0.0277000000BTC,787.81570000USDT,0.7878157000USDT
2023-04-04 11:08:30,BTCUSDT,SELL,"28,441.0000000000",0.0007600000BTC,21.61516000USDT,0.0216151600USDT
2023-04-03 12:31:28,BTCUSDT,BUY,"28,168.0000000000",0.0355000000BTC,999.96400000USDT,0.0000355000BTC
2023-04-03 10:30:46,BTCUSDT,SELL,"28,464.0000000000",0.0307500000BTC,875.26800000USDT,0.8752680000USDT
2023-04-03 10:30:46,BTCUSDT,SELL,"28,464.0000000000",0.0044400000BTC,126.38016000USDT,0.1263801600USDT
2023-04-02 10:32:59,BTCUSDT,BUY,"28,376.9800000000",0.0352300000BTC,999.72100540USDT,0.0000352300BTC
2023-03-29 10:19:03,BUSDUSDT,BUY,0.9997000000,400.0000000000BUSD,399.88000000USDT,0.0000000000BUSD
2023-03-29 08:55:36,BTCUSDT,SELL,"28,528.7900000000",0.5605000000BTC,"15,990.38679500USDT",15.9903868000USDT
2023-03-27 15:09:37,BTCUSDT,BUY,"26,727.6900000000",0.0037100000BTC,99.15972990USDT,0.0000037100BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,734.1100000000",0.0165700000BTC,442.98420270USDT,0.0000165700BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,727.3200000000",0.0010800000BTC,28.86550560USDT,0.0000010800BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,727.3100000000",0.0022300000BTC,59.60190130USDT,0.0000022300BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,727.2900000000",0.0063100000BTC,168.64919990USDT,0.0000063100BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,730.5400000000",0.0112200000BTC,299.91665880USDT,0.0000112200BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,734.0000000000",0.0066900000BTC,178.85046000USDT,0.0000066900BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,735.5400000000",0.0151000000BTC,403.70665400USDT,0.0000151000BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,730.5400000000",0.0004100000BTC,10.95952140USDT,0.0000004100BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,729.9200000000",0.0127300000BTC,340.27188160USDT,0.0000127300BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,735.5200000000",0.1120000000BTC,"2,994.37824000USDT",0.0001120000BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,733.0100000000",0.1145300000BTC,"3,061.73163530USDT",0.0001145300BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,733.0200000000",0.0935700000BTC,"2,501.40868140USDT",0.0000935700BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,728.6300000000",0.0066300000BTC,177.21081690USDT,0.0000066300BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,731.0000000000",0.0005000000BTC,13.36550000USDT,0.0000005000BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,727.3200000000",0.0017700000BTC,47.30735640USDT,0.0000017700BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,730.5800000000",0.0112200000BTC,299.91710760USDT,0.0000112200BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,731.2200000000",0.0004100000BTC,10.95980020USDT,0.0000004100BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,727.2900000000",0.0971400000BTC,"2,596.28895060USDT",0.0000971400BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,730.5400000000",0.0112200000BTC,299.91665880USDT,0.0000112200BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,727.3300000000",0.0026600000BTC,71.09469780USDT,0.0000026600BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,734.1000000000",0.0057800000BTC,154.52309800USDT,0.0000057800BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,727.2900000000",0.0067400000BTC,180.14193460USDT,0.0000067400BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,731.2200000000",0.0112200000BTC,299.92428840USDT,0.0000112200BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,734.0900000000",0.0028900000BTC,77.26152010USDT,0.0000028900BTC
2023-03-27 15:09:37,BTCUSDT,BUY,"26,730.7600000000",0.0067900000BTC,181.50186040USDT,0.0000067900BTC
2023-03-23 16:52:27,ARBUSDT,BUY,1.2565000000,421.3000000000ARB,529.36345000USDT,0.4213000000ARB
2023-03-23 16:52:27,ARBUSDT,BUY,1.2567000000,"1,940.8000000000ARB","2,439.00336000USDT",1.9408000000ARB
2023-03-23 16:52:27,ARBUSDT,BUY,1.2566000000,425.6000000000ARB,534.80896000USDT,0.4256000000ARB
2023-03-23 16:52:27,ARBUSDT,BUY,1.2565000000,"1,191.2000000000ARB","1,496.74280000USDT",1.1912000000ARB
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103200,"590,553,553.0000000000SHIB","6,094.51266696USDT",6.0945126700USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103300,"35,710,965.0000000000SHIB",368.89426845USDT,0.3688942700USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103200,"7,792,513.0000000000SHIB",80.41873416USDT,0.0804187300USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103300,"22,866,042.0000000000SHIB",236.20621386USDT,0.2362062100USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103200,"10,297,249.0000000000SHIB",106.26760968USDT,0.1062676100USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103300,"24,710,152.0000000000SHIB",255.25587016USDT,0.2552558700USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103300,"3,375,000.0000000000SHIB",34.86375000USDT,0.0348637500USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103300,"150,000,000.0000000000SHIB","1,549.50000000USDT",1.5495000000USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103200,"35,710,965.0000000000SHIB",368.53715880USDT,0.3685371600USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103200,"56,720,733.0000000000SHIB",585.35796456USDT,0.5853579600USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103300,"62,486,800.0000000000SHIB",645.48864400USDT,0.6454886400USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103200,"1,453,488.0000000000SHIB",14.99999616USDT,0.0150000000USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103200,"607,088,971.0000000000SHIB","6,265.15818072USDT",6.2651581800USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103300,"21,638,931.0000000000SHIB",223.53015723USDT,0.2235301600USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103300,"98,505,848.0000000000SHIB","1,017.56540984USDT",1.0175654100USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103200,"5,287,776.0000000000SHIB",54.56984832USDT,0.0545698500USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103200,"30,000,000.0000000000SHIB",309.60000000USDT,0.3096000000USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103200,"12,801,985.0000000000SHIB",132.11648520USDT,0.1321164900USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103200,"15,306,722.0000000000SHIB",157.96537104USDT,0.1579653700USDT
2023-03-16 01:11:56,SHIBUSDT,SELL,0.0000103300,"7,692,307.0000000000SHIB",79.46153131USDT,0.0794615300USDT
2023-03-16 01:09:23,SHIBUSDT,SELL,0.0000103200,"29,243,681.0000000000SHIB",301.79478792USDT,0.3017947900USDT
2023-03-16 01:09:23,SHIBUSDT,SELL,0.0000103200,"187,496,537.0000000000SHIB","1,934.96426184USDT",1.9349642600USDT
2023-03-10 09:36:59,SHIBBUSD,BUY,0.0000099700,"12,763,777.0000000000SHIB",127.25485669BUSD,0.0000000000SHIB
2023-01-18 01:01:03,SHIBBUSD,SELL,0.0000113900,"11,172,507.0000000000SHIB",127.25485473BUSD,0.0000000000BUSD
2023-01-11 11:21:51,SHIBBUSD,BUY,0.0000089300,"11,760,534.0000000000SHIB",105.02156862BUSD,0.0000000000SHIB
2023-01-10 11:46:26,SHIBBUSD,SELL,0.0000096600,"10,871,798.0000000000SHIB",105.02156868BUSD,0.0000000000BUSD
2023-01-09 03:31:35,ETHBTC,SELL,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000002400BTC
2023-01-06 16:02:26,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2023-01-04 03:07:08,ETHBTC,SELL,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000002300BTC
2023-01-04 01:19:59,ETHBTC,SELL,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000002300BTC
2022-12-22 21:08:40,ETHBTC,BUY,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000031000ETH
2022-12-22 20:22:23,ETHBTC,SELL,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000002300BTC
2022-12-22 20:21:39,ETHBTC,SELL,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000002200BTC
2022-12-22 15:02:07,ETHBTC,BUY,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000031000ETH
2022-12-22 09:37:25,ETHBTC,SELL,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000002200BTC
2022-12-20 01:24:17,ETHBTC,SELL,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000002200BTC
2022-12-16 16:08:58,ETHBTC,BUY,0.0705820000,0.0031000000ETH,0.00021880BTC,0.0000031000ETH
2022-12-16 09:00:32,ETHBTC,BUY,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000031000ETH
2022-12-16 08:54:50,ETHBTC,BUY,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000031000ETH
2022-12-14 18:56:35,ETHBTC,BUY,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000031000ETH
2022-12-08 18:50:25,ETHBTC,SELL,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000002300BTC
2022-12-07 19:48:25,SHIBBUSD,BUY,0.0000091300,"10,882,681.0000000000SHIB",99.35887753BUSD,"10,882.6800000000SHIB"
2022-12-07 07:12:52,ETHBTC,BUY,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000031000ETH
2022-12-05 15:17:06,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-12-05 00:36:40,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2022-12-03 22:31:41,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-12-03 08:35:21,ETHBTC,BUY,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000031000ETH
2022-12-03 00:03:26,ETHBTC,SELL,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000002400BTC
2022-11-30 00:40:35,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2022-11-29 20:08:36,ETHBTC,SELL,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000002300BTC
2022-11-29 05:11:18,ETHBTC,SELL,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000002300BTC
2022-11-28 01:11:01,ETHBTC,BUY,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000031000ETH
2022-11-28 01:11:01,ETHBTC,BUY,0.0723670000,0.0017000000ETH,0.00012302BTC,0.0000017000ETH
2022-11-26 01:21:00,ETHBTC,SELL,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000002300BTC
2022-11-25 12:34:09,ETHBTC,SELL,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000002200BTC
2022-11-25 04:54:23,ETHBTC,BUY,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000031000ETH
2022-11-24 06:58:36,ETHBTC,SELL,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000002200BTC
2022-11-23 23:18:03,ETHBTC,SELL,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000002200BTC
2022-11-23 12:24:39,SHIBBUSD,BUY,0.0000090000,"22,303,198.0000000000SHIB",200.72878200BUSD,0.0000000000SHIB
2022-11-23 12:24:39,SHIBBUSD,BUY,0.0000090000,"215,337,207.0000000000SHIB","1,938.03486300BUSD",0.0000000000SHIB
2022-11-23 02:30:13,ETHBTC,SELL,0.0705820000,0.0031000000ETH,0.00021880BTC,0.0000002200BTC
2022-11-23 02:18:09,ETHBTC,BUY,0.0697050000,0.0031000000ETH,0.00021609BTC,0.0000031000ETH
2022-11-23 00:23:10,ETHBTC,SELL,0.0705820000,0.0031000000ETH,0.00021880BTC,0.0000002200BTC
2022-11-22 13:48:31,ETHBTC,SELL,0.0697050000,0.0031000000ETH,0.00021609BTC,0.0000002200BTC
2022-11-22 08:40:52,SHIBBUSD,BUY,0.0000082800,"233,726,893.0000000000SHIB","1,935.25867404BUSD",0.0000000000SHIB
2022-11-22 08:40:51,SHIBBUSD,BUY,0.0000082800,"27,792,189.0000000000SHIB",230.11932492BUSD,0.0000000000SHIB
2022-11-22 08:40:49,SHIBBUSD,BUY,0.0000082800,"2,021,988.0000000000SHIB",16.74206064BUSD,0.0000000000SHIB
2022-11-22 08:40:47,SHIBBUSD,BUY,0.0000082800,"3,109,052.0000000000SHIB",25.74295056BUSD,0.0000000000SHIB
2022-11-22 08:40:41,SHIBBUSD,BUY,0.0000082800,"197,554,656.0000000000SHIB","1,635.75255168BUSD",0.0000000000SHIB
2022-11-22 08:18:40,ETHBTC,BUY,0.0688400000,0.0031000000ETH,0.00021340BTC,0.0000031000ETH
2022-11-22 01:07:47,ETHBTC,BUY,0.0697050000,0.0031000000ETH,0.00021609BTC,0.0000031000ETH
2022-11-21 22:21:27,ETHBTC,SELL,0.0705820000,0.0031000000ETH,0.00021880BTC,0.0000002200BTC
2022-11-21 20:09:53,ETHBTC,SELL,0.0697050000,0.0031000000ETH,0.00021609BTC,0.0000002200BTC
2022-11-21 18:04:40,ETHBTC,BUY,0.0688400000,0.0031000000ETH,0.00021340BTC,0.0000031000ETH
2022-11-21 01:58:28,ETHBTC,BUY,0.0697050000,0.0031000000ETH,0.00021609BTC,0.0000031000ETH
2022-11-20 21:52:31,ETHBTC,BUY,0.0705820000,0.0031000000ETH,0.00021880BTC,0.0000031000ETH
2022-11-20 19:55:14,ETHBTC,SELL,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000002200BTC
2022-11-20 11:34:46,ETHBTC,BUY,0.0705820000,0.0031000000ETH,0.00021880BTC,0.0000031000ETH
2022-11-20 11:19:41,ETHBTC,BUY,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000031000ETH
2022-11-20 10:32:45,ETHBTC,BUY,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000031000ETH
2022-11-19 22:27:42,ETHBTC,SELL,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000002300BTC
2022-11-17 19:58:30,SHIBUSDT,BUY,0.0000090500,"46,439,613.0000000000SHIB",420.27849765USDT,"46,439.6100000000SHIB"
2022-11-17 19:58:30,SHIBUSDT,BUY,0.0000090500,"282,743,457.0000000000SHIB","2,558.82828585USDT","282,743.4600000000SHIB"
2022-11-17 19:58:30,SHIBUSDT,BUY,0.0000090500,"44,391,703.0000000000SHIB",401.74491215USDT,"44,391.7000000000SHIB"
2022-11-17 19:58:30,SHIBUSDT,BUY,0.0000090500,"26,069,111.0000000000SHIB",235.92545455USDT,"26,069.1100000000SHIB"
2022-11-17 19:58:30,SHIBUSDT,BUY,0.0000090500,"36,555,770.0000000000SHIB",330.82971850USDT,"36,555.7700000000SHIB"
2022-11-17 07:01:13,ETHBTC,BUY,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000031000ETH
2022-11-16 16:40:46,ETHBTC,SELL,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000002300BTC
2022-11-16 16:03:02,ETHBTC,BUY,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000031000ETH
2022-11-16 13:00:12,SHIBUSDT,BUY,0.0000092300,"74,376,244.0000000000SHIB",686.49273212USDT,"74,376.2400000000SHIB"
2022-11-16 13:00:12,SHIBUSDT,BUY,0.0000092300,"254,176,732.0000000000SHIB","2,346.05123636USDT","254,176.7300000000SHIB"
2022-11-16 12:54:36,SHIBUSDT,BUY,0.0000092300,"10,000,000.0000000000SHIB",92.30000000USDT,"10,000.0000000000SHIB"
2022-11-16 12:54:36,SHIBUSDT,BUY,0.0000092300,"24,281,519.0000000000SHIB",224.11842037USDT,"24,281.5200000000SHIB"
2022-11-16 12:54:36,SHIBUSDT,BUY,0.0000092300,"12,146,000.0000000000SHIB",112.10758000USDT,"12,146.0000000000SHIB"
2022-11-16 12:54:36,SHIBUSDT,BUY,0.0000092300,"10,000,000.0000000000SHIB",92.30000000USDT,"10,000.0000000000SHIB"
2022-11-16 12:54:36,SHIBUSDT,BUY,0.0000092300,"7,854,000.0000000000SHIB",72.49242000USDT,"7,854.0000000000SHIB"
2022-11-16 12:54:36,SHIBUSDT,BUY,0.0000092300,"40,000,000.0000000000SHIB",369.20000000USDT,"40,000.0000000000SHIB"
2022-11-16 11:50:31,ETHBTC,BUY,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000031000ETH
2022-11-15 20:21:04,SHIBUSDT,BUY,0.0000092300,"115,000,000.0000000000SHIB","1,061.45000000USDT","115,000.0000000000SHIB"
2022-11-15 20:21:04,SHIBUSDT,BUY,0.0000092300,"161,738,856.0000000000SHIB","1,492.84964088USDT","161,738.8600000000SHIB"
2022-11-15 20:21:04,SHIBUSDT,BUY,0.0000092300,"153,681,267.0000000000SHIB","1,418.47809441USDT","153,681.2700000000SHIB"
2022-11-15 18:31:38,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-11-15 00:31:05,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2022-11-14 19:47:39,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-11-14 08:04:29,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2022-11-13 08:56:44,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-11-12 03:23:14,ETHBTC,BUY,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000031000ETH
2022-11-11 23:40:55,ETHBTC,SELL,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000002400BTC
2022-11-11 17:47:55,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2022-11-11 16:01:41,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-11-11 15:31:16,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2022-11-11 15:31:01,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-11-11 15:25:57,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2022-11-11 14:55:22,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-11-11 14:49:32,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2022-11-11 14:47:26,ETHBTC,SELL,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000002300BTC
2022-11-11 14:15:36,ETHBTC,BUY,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000031000ETH
2022-11-11 12:54:14,ETHBTC,SELL,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000002300BTC
2022-11-11 05:48:09,ETHBTC,SELL,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000002300BTC
2022-11-11 03:07:45,ETHBTC,BUY,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000031000ETH
2022-11-11 01:32:28,ETHBTC,BUY,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000031000ETH
2022-11-10 20:21:51,ETHBTC,SELL,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000002300BTC
2022-11-10 17:36:24,ETHBTC,BUY,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000031000ETH
2022-11-10 16:57:20,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-11-10 14:57:22,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2022-11-10 14:43:25,ETHBTC,SELL,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000002300BTC
2022-11-10 14:05:44,ETHBTC,BUY,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000031000ETH
2022-11-10 13:34:08,ETHBTC,SELL,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000002300BTC
2022-11-10 13:30:12,ETHBTC,SELL,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000002300BTC
2022-11-10 11:16:43,ETHBTC,SELL,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000002200BTC
2022-11-10 09:31:22,ETHBTC,BUY,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000031000ETH
2022-11-10 09:06:44,ETHBTC,SELL,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000002200BTC
2022-11-10 08:31:48,ETHBTC,SELL,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000002200BTC
2022-11-10 06:23:00,ETHBTC,BUY,0.0705820000,0.0031000000ETH,0.00021880BTC,0.0000031000ETH
2022-11-10 03:08:31,ETHBTC,SELL,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000002200BTC
2022-11-10 01:01:14,ETHBTC,SELL,0.0705820000,0.0031000000ETH,0.00021880BTC,0.0000002200BTC
2022-11-10 00:17:06,ETHBTC,SELL,0.0697050000,0.0031000000ETH,0.00021609BTC,0.0000002200BTC
2022-11-09 23:37:21,ETHBTC,BUY,0.0688400000,0.0031000000ETH,0.00021340BTC,0.0000031000ETH
2022-11-09 23:21:34,ETHBTC,BUY,0.0697050000,0.0031000000ETH,0.00021609BTC,0.0000031000ETH
2022-11-09 21:22:24,ETHBTC,BUY,0.0705820000,0.0031000000ETH,0.00021880BTC,0.0000031000ETH
2022-11-09 20:52:21,ETHBTC,SELL,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000002200BTC
2022-11-09 19:04:23,ETHBTC,SELL,0.0705820000,0.0031000000ETH,0.00021880BTC,0.0000002200BTC
2022-11-09 18:44:42,ETHBTC,SELL,0.0697050000,0.0031000000ETH,0.00021609BTC,0.0000002200BTC
2022-11-09 16:43:35,ETHBTC,SELL,0.0688400000,0.0031000000ETH,0.00021340BTC,0.0000002100BTC
2022-11-09 15:43:39,ETHBTC,BUY,0.0679850000,0.0031000000ETH,0.00021075BTC,0.0000031000ETH
2022-11-09 15:35:17,ETHBTC,BUY,0.0688400000,0.0031000000ETH,0.00021340BTC,0.0000031000ETH
2022-11-09 14:45:58,ETHBTC,SELL,0.0697050000,0.0031000000ETH,0.00021609BTC,0.0000002200BTC
2022-11-09 13:51:45,ETHBTC,BUY,0.0688400000,0.0031000000ETH,0.00021340BTC,0.0000031000ETH
2022-11-09 12:57:08,ETHBTC,SELL,0.0697050000,0.0031000000ETH,0.00021609BTC,0.0000002200BTC
2022-11-09 12:03:28,ETHBTC,SELL,0.0688400000,0.0031000000ETH,0.00021340BTC,0.0000002100BTC
2022-11-09 11:19:58,ETHBTC,SELL,0.0679850000,0.0031000000ETH,0.00021075BTC,0.0000002100BTC
2022-11-09 11:06:54,ETHBTC,BUY,0.0671410000,0.0031000000ETH,0.00020814BTC,0.0000031000ETH
2022-11-09 10:38:19,ETHBTC,SELL,0.0679850000,0.0031000000ETH,0.00021075BTC,0.0000002100BTC
2022-11-09 10:23:09,ETHBTC,SELL,0.0671410000,0.0031000000ETH,0.00020814BTC,0.0000002100BTC
2022-11-09 10:19:21,ETHBTC,BUY,0.0663070000,0.0031000000ETH,0.00020555BTC,0.0000031000ETH
2022-11-09 10:14:50,ETHBTC,BUY,0.0671410000,0.0031000000ETH,0.00020814BTC,0.0000031000ETH
2022-11-09 10:10:21,ETHBTC,BUY,0.0679850000,0.0031000000ETH,0.00021075BTC,0.0000031000ETH
2022-11-09 10:00:22,ETHBTC,BUY,0.0688200000,0.0031000000ETH,0.00021334BTC,0.0000031000ETH
2022-11-09 10:00:22,ETHBTC,SELL,0.0697050000,0.0031000000ETH,0.00021609BTC,0.0000002200BTC
2022-11-09 10:00:22,ETHBTC,SELL,0.0688400000,0.0031000000ETH,0.00021340BTC,0.0000002100BTC
2022-11-09 09:48:57,ETHBTC,BUY,0.0679850000,0.0031000000ETH,0.00021075BTC,0.0000031000ETH
2022-11-09 09:18:06,ETHBTC,BUY,0.0688400000,0.0031000000ETH,0.00021340BTC,0.0000031000ETH
2022-11-09 07:48:24,ETHBTC,BUY,0.0697050000,0.0031000000ETH,0.00021609BTC,0.0000031000ETH
2022-11-09 07:16:23,ETHBTC,BUY,0.0705820000,0.0031000000ETH,0.00021880BTC,0.0000031000ETH
2022-11-08 21:18:21,ETHBTC,BUY,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000031000ETH
2022-11-08 20:46:39,ETHBTC,SELL,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000002200BTC
2022-11-08 20:24:00,ETHBTC,BUY,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000031000ETH
2022-11-08 19:36:03,ETHBTC,SELL,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000002200BTC
2022-11-08 19:34:52,ETHBTC,BUY,0.0714690000,0.0031000000ETH,0.00022155BTC,0.0000031000ETH
2022-11-08 18:56:03,ETHBTC,BUY,0.0723680000,0.0031000000ETH,0.00022434BTC,0.0000031000ETH
2022-11-08 18:19:52,ETHBTC,BUY,0.0732780000,0.0031000000ETH,0.00022716BTC,0.0000031000ETH
2022-11-08 18:05:54,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-11-08 17:53:20,ETHBTC,BUY,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000031000ETH
2022-11-08 16:21:30,ETHBTC,BUY,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000031000ETH
2022-11-08 16:13:32,ETHBTC,SELL,0.0770330000,0.0031000000ETH,0.00023880BTC,0.0000002400BTC
2022-11-08 16:08:29,ETHBTC,SELL,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000002400BTC
2022-11-08 16:04:33,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2022-11-08 14:43:18,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-11-08 06:53:26,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2022-11-08 05:13:35,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-11-08 04:24:03,ETHBTC,SELL,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000002300BTC
2022-11-08 04:09:56,ETHBTC,BUY,0.0741990000,0.0031000000ETH,0.00023002BTC,0.0000031000ETH
2022-11-08 03:00:31,ETHBTC,BUY,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000031000ETH
2022-11-07 22:01:04,ETHBTC,BUY,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000031000ETH
2022-11-07 19:34:48,ETHBTC,SELL,0.0770330000,0.0031000000ETH,0.00023880BTC,0.0000002400BTC
2022-11-07 10:17:45,ETHBTC,SELL,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000002400BTC
2022-11-07 07:53:52,ETHBTC,BUY,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000031000ETH
2022-11-07 05:01:30,ETHBTC,SELL,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000002400BTC
2022-11-06 23:13:39,ETHBTC,BUY,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000031000ETH
2022-11-06 02:49:48,ETHBTC,BUY,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000031000ETH
2022-11-05 03:01:28,ETHBTC,BUY,0.0770330000,0.0031000000ETH,0.00023880BTC,0.0000031000ETH
2022-11-04 14:12:53,ETHBTC,SELL,0.0780020000,0.0031000000ETH,0.00024181BTC,0.0000002400BTC
2022-11-04 08:00:21,ETHBTC,SELL,0.0770330000,0.0031000000ETH,0.00023880BTC,0.0000002400BTC
2022-11-03 01:46:01,ETHBTC,SELL,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000002400BTC
2022-11-02 20:13:16,ETHBTC,BUY,0.0751320000,0.0031000000ETH,0.00023291BTC,0.0000031000ETH
2022-11-02 19:21:06,ETHBTC,BUY,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000031000ETH
2022-11-02 19:09:26,ETHBTC,SELL,0.0770330000,0.0031000000ETH,0.00023880BTC,0.0000002400BTC
2022-11-02 18:53:27,ETHBTC,BUY,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000031000ETH
2022-11-02 18:38:12,ETHBTC,BUY,0.0770330000,0.0031000000ETH,0.00023880BTC,0.0000031000ETH
2022-11-02 18:17:11,ETHBTC,SELL,0.0780020000,0.0031000000ETH,0.00024181BTC,0.0000002400BTC
2022-11-02 18:05:35,ETHBTC,SELL,0.0770330000,0.0031000000ETH,0.00023880BTC,0.0000002400BTC
2022-11-02 10:03:12,ETHBTC,BUY,0.0760770000,0.0031000000ETH,0.00023584BTC,0.0000031000ETH
`


const prepare = (history) => {
    return CSV.parse(history).map(l => l.map(sl => sl.replace(/\,/g,"").replace(/\./g,",").replace(/-/g,"/")))
}

const separeSymbol = (str) => {
    const value = str.match(/[0-9\,]+/g)?.[0];
    const symbol = str.match(/[A-Z]+/g)?.[0];

        return `${value}\t${symbol}`
    
}

const parse = (lines) => {
    
return     lines.map(line => {
        if(!line[0]) return

        const [date, pair, side, price, executed, amount, fee ] = line
        
        return `${date}\t${pair}\t${side}\t${price}\t${separeSymbol(executed)}\t${separeSymbol(amount)}\t${separeSymbol(fee)}`
    })
    


}


const parsed = parse(prepare(history)).join("\n")

writeFile('binanceParsed.csv', parsed, (err) => console.error(err))

